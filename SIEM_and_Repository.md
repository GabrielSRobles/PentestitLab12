# SIEM AND Repository

This is related to a **SIEM**, a **Security Information and Event Management**, system.
This sistem can be found among the IPs that we gathered during the VPN challenge.

## Info gathering

After entering IP 172.16.1.12 we get a login page, which uses a set of the credentials that we found previously.
Use the password for sviridov and you will gain access to the system.

At first time it seems empty, but altering the filters to bring the whole history of logs and allow us to read them all.

These logs at first sight may not show us anything too interesting, but we will get some more info as we read them.

Lets look at some of the logs:

### Ossec agent started

Here we see logs of a starting process, and several IPs with what seem to be users starting the server.

* (vpn-admin.test.lab) 172.16.1.10->ossec
* (repository.test.lab) 172.16.1.15->ossec
* (admin.test.lab) 172.16.1.25->ossec

- The first one shows us the token we botained in the VPN challenge
- The second one prompts us for credentials
- The third does not answer

###  Unknown problem somewhere in the system

This is a very vague error, and unexpected behaviors are sometimes misshandled. Lets look at it.

`Dec 11 22:49:01 repository repo_check[1]: ERROR: wget -O- 'http://admin:IFGpajdlkmaw2of@localhost" exit with error 1`

Okey, so we fee a few things. First a **repository** tag, maybe this is related tyo the previous repository.test.lab? Then we have what seems to be a login to an HTTP service, but the host is set to localhost.

Lets try to combine both infos we got, and navigate to **http://admin:IFGpajdlkmaw2of@172.16.1.15**. And success, we have a new token. It is the **repository** token. 

Maybe this is the generic admin pasasword? Could be useful for something else later on. Lets keep it in mind.


### User missed the password to change UID (user id).

Here we can find a log that contains the token. A bit artificial, but it works:

Log:  `Dec 11 23:00:45 repository su[6615]: FAILED su for siem_token_d2ijf43mqp by root`

The token is in the name of the user that root tried to impersonate.